{% extends "base.html" %}

{% block title %}Blog Posts - Learning Library{% endblock %}
{% block css_path %}../assets/style.css{% endblock %}
{% block home_path %}../index.html{% endblock %}
{% block nav_home %}../index.html{% endblock %}
{% block nav_papers %}../papers/index.html{% endblock %}
{% block nav_podcasts %}../podcasts/index.html{% endblock %}
{% block nav_blogs %}index.html{% endblock %}
{% block nav_channels %}../channels/index.html{% endblock %}
{% block nav_browse %}../browse/a.html{% endblock %}

{% block content %}
<a href="../index.html" class="back-link">← Back to Library</a>

<div class="page-header">
    <h2>Blog Posts</h2>
    <p class="subtitle">{{ entries|length }} articles from {{ sources|length if sources else 0 }} blogs</p>
</div>

<!-- Source Filters -->
{% if sources %}
<div class="filters" style="margin-bottom: 1.5rem;">
    <strong>Filter by blog:</strong>
    {% for source in sources %}
    <a href="../blogs/source/{{ source.slug }}.html" class="tag">{{ source.name }}</a>
    {% endfor %}
</div>
{% endif %}

<!-- Topic Filters -->
<div class="filters" style="margin-bottom: 1.5rem;">
    <strong>Filter by topic:</strong>
    {% for topic in topics %}
    <a href="../topics/{{ topic }}.html" class="tag">{{ topic }}</a>
    {% endfor %}
</div>

<!-- Sort Options -->
<div class="sort-options" style="margin-bottom: 1rem; color: var(--text-muted);">
    Sorted by: <strong>Date Published</strong> (newest first)
</div>

<!-- Blog Posts List -->
<ul class="entry-list blogs-list">
    {% for entry in entries %}
    <li class="entry-card blog-card">
        <div class="entry-header">
            <span class="content-type-badge blog-badge">Blog</span>
            {% if entry.is_trusted_source %}
            <span class="trusted-badge" title="Trusted source">★</span>
            {% endif %}
            <a href="{{ entry.slug }}.html" class="entry-title">{{ entry.title }}</a>
        </div>
        <div class="entry-meta">
            {% if entry.author %}
            <span class="author">{{ entry.author.name }}</span>
            •
            {% endif %}
            {% if entry.blog %}
            <span class="blog-name">{{ entry.blog.name }}</span>
            •
            {% endif %}
            {% for topic in entry.facets.topics %}
            <span class="tag tag-small">{{ topic }}</span>
            {% endfor %}
            •
            <span class="difficulty">{{ entry.facets.difficulty }}</span>
            {% if entry.word_count %}
            •
            <span class="word-count">{{ entry.word_count }} words</span>
            {% endif %}
            {% if entry.quality_score and not entry.is_trusted_source %}
            •
            <span class="quality-score" title="Quality score">Q:{{ entry.quality_score }}</span>
            {% endif %}
            •
            <span class="date">{{ entry.published_date }}</span>
        </div>
        {% if entry.summary %}
        <div class="entry-summary">
            {{ entry.summary[0][:200] }}{% if entry.summary[0]|length > 200 %}...{% endif %}
        </div>
        {% endif %}
    </li>
    {% endfor %}
</ul>

{% if entries|length == 0 %}
<p class="empty-state">No blog posts imported yet. Run <code>python blog_import.py &lt;url&gt;</code> to import articles.</p>
{% endif %}

{% endblock %}
